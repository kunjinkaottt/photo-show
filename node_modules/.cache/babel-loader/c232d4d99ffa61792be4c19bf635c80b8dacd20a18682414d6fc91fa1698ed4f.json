{"ast":null,"code":"// import axios from 'axios'\nimport { WaterFall } from \"@/waterfall/waterfall\"; //js那边不是export default默认导出,所以这里要用花括号，不然获取不到\n\nfunction importAll(r) {\n  //导入多个模块\n  return r.keys().map(function (key) {\n    return r(key); //webpack提供的r方法,返回上下文(context)接口的函数。将每个模块都通过r(key)导入进来,将获取的相对路径作为参数传递给 r 函数，并返回导入的模块对象\n  });\n}\n\n// 杜震\nexport default {\n  name: 'LocalImg',\n  data() {\n    return {\n      imgList: [],\n      type: 'recommend',\n      //tab中选择的图片分类\n      firstRowNums: 0,\n      firstRowImgsHeight: [],\n      columns: 4,\n      timmer: null\n    };\n  },\n  created() {\n    const images = importAll(require.context('@/assets/imgs', false, /\\.(png|jpe?g|svg)$/));\n    this.imgList = images;\n  },\n  mounted() {\n    // 监听窗口大小变化事件，并实时更新数据属性中的宽度和高度值\n    // window.addEventListener('resize', this.imageOnload);\n    window.onresize = () => {\n      clearTimeout(this.timmer);\n      setTimeout(() => {\n        this.imageOnload();\n      }, 600);\n    };\n  },\n  methods: {\n    handleImageLoad(index) {\n      // //获取主容器宽度\n      // var content = this.$refs.content\n      // var contentWidth = content.offsetWidth\n\n      // // img标签的dom数组\n      // var imgs = this.$refs.image\n      // var imgWidth = imgs[0].offsetWidth\n\n      // // 获取第一行的图片整数 \n      // this.firstRowNums = Math.floor(contentWidth / imgWidth)\n\n      //     const image = this.$refs.image\n      //     if (index < this.firstRowNums) { //第一行\n      //         // 获取第一行全部图片的高度 存到数组\n      //         var imgHeight = image[index].offsetHeight\n      //         this.firstRowImgsHeight.push(imgHeight)\n      //     }\n      //     else if(index > this.firstRowNums){  //第二行往后\n      //         var obj = {\n      //             minHeight: this.firstRowImgsHeight[0],   //第一行最短的高度\n      //             minIndex: 0  // 第一行高度最矮的那一项的下标\n      //         }\n      //         console.log(this.firstRowImgsHeight);\n      //         for (let j = 0; j < this.firstRowImgsHeight.length; j++) {\n      //             if (this.firstRowImgsHeight[j] < obj.minHeight) {  //找到第一行高度最小那一项\n      //                 obj.minHeight = this.firstRowImgsHeight[j]\n      //                 obj.minIndex = j\n      //             }\n      //         }\n      //         image[index].style.position = \"absolute\"\n      //         image[index].style.top = obj.minHeight + \"px\"\n      //         image[index].style.left = image[obj.minIndex].offsetLeft + \"px\"\n      //         this.firstRowImgsHeight[obj.minIndex] = this.firstRowImgsHeight[obj.minIndex] + image[index].height\n      //     }\n    },\n    imageOnload() {\n      //加载图片 根据浏览器宽度决定列数\n      if (window.innerWidth > 1500) {\n        this.columns = 4;\n      } else if (window.innerWidth > 1200) {\n        this.columns = 3;\n      } else if (window.innerWidth > 800) {\n        this.columns = 2;\n      } else if (window.innerWidth >= 500) {\n        this.columns = 1;\n      }\n      new WaterFall({\n        //执行waterfall.js文件中的构造函数\n        el: \".wf-content\",\n        column: this.columns,\n        gap: 23 //间距  单位px\n      });\n    },\n\n    loginRegist() {\n      //改变弹窗可视化，触发登陆注册弹窗\n      this.$store.commit('turnVisible');\n    }\n  },\n  watch: {\n    '$store.state.choose'(newVal) {\n      switch (newVal) {\n        case 0:\n          this.imgList = null;\n          this.imgList = importAll(require.context('@/assets/imgs/recommend', false, /\\.(png|jpe?g|svg)$/));\n          break;\n        case 1:\n          this.imgList = null;\n          this.imgList = importAll(require.context('@/assets/imgs/art', false, /\\.(png|jpe?g|svg)$/));\n          break;\n        case 2:\n          debugger;\n          this.imgList = null;\n          this.imgList = importAll(require.context('@/assets/video', false, /\\.(mp4)$/));\n          this.imageOnload();\n          //视频标签在浏览器加载完成时调用\n          // window.onload = function () {\n          //     var videoDom = document.getElementById(\"videoList\")\n          //     videoDom.addEventListener(\"canplaythrough\", () => this.imageOnload());\n          // }\n          break;\n        case 3:\n          this.imgList = null;\n          this.imgList = importAll(require.context('@/assets/imgs/game', false, /\\.(png|jpe?g|svg)$/));\n          break;\n        case 4:\n          this.imgList = null;\n          this.imgList = importAll(require.context('@/assets/imgs/pet', false, /\\.(png|jpe?g|svg)$/));\n          break;\n        case 5:\n          this.imgList = null;\n          this.imgList = importAll(require.context('@/assets/imgs/industryDesign', false, /\\.(png|jpe?g|svg)$/));\n          break;\n        case 6:\n          this.imgList = null;\n          this.imgList = importAll(require.context('@/assets/imgs/car', false, /\\.(png|jpe?g|svg)$/));\n        default:\n          break;\n      }\n    }\n  }\n};","map":{"version":3,"names":["WaterFall","importAll","r","keys","map","key","name","data","imgList","type","firstRowNums","firstRowImgsHeight","columns","timmer","created","images","require","context","mounted","window","onresize","clearTimeout","setTimeout","imageOnload","methods","handleImageLoad","index","innerWidth","el","column","gap","loginRegist","$store","commit","watch","$store.state.choose","newVal"],"sources":["src/components/LocalImg.vue"],"sourcesContent":["<template>\r\n    <div class=\"Waterfall wf-content\"> <!-- 如果不用wf-content？ -->\r\n        <!-- 遍历图片数组获取图片 -->\r\n        <div class=\"wf-item mask\" v-for=\"(item, index) in imgList\" :key=\"index\">\r\n            <video id=\"videoList\" v-if=\"$store.state.choose === 2\"  :src=\"item\"></video>\r\n            <video v-if=\"$store.state.choose === 2 ? imageOnload():''\"  :src=\"item\"></video>\r\n            <img v-else v-lazy=\"item\" alt=\"xxx\" ref=\"image\" @load=\"imageOnload()\" />\r\n            <a class=\"collect icons\" @click=\"loginRegist()\"><img title=\"收藏\" src=\"../assets/icons/收藏.png\" alt=\"\"></a>\r\n            <a class=\"like icons\" @click=\"loginRegist()\"><img title=\"点赞\" src=\"../assets/icons/赞.png\" alt=\"\"></a>\r\n            <a class=\"download icons\" @click=\"loginRegist()\"><img title=\"下载\" src=\"../assets/icons/下载.png\" alt=\"\"></a>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n// import axios from 'axios'\r\nimport { WaterFall } from \"@/waterfall/waterfall\";    //js那边不是export default默认导出,所以这里要用花括号，不然获取不到\r\n\r\nfunction importAll(r) {//导入多个模块\r\n    return r.keys().map(function (key) {\r\n        return r(key);//webpack提供的r方法,返回上下文(context)接口的函数。将每个模块都通过r(key)导入进来,将获取的相对路径作为参数传递给 r 函数，并返回导入的模块对象\r\n    });\r\n}\r\n\r\n// 杜震\r\nexport default {\r\n    name: 'LocalImg',\r\n    data() {\r\n        return {\r\n            imgList: [],\r\n            type: 'recommend', //tab中选择的图片分类\r\n            firstRowNums: 0,\r\n            firstRowImgsHeight: [],\r\n            columns: 4,\r\n            timmer: null,\r\n        }\r\n    },\r\n    created() {\r\n        const images = importAll(require.context('@/assets/imgs', false, /\\.(png|jpe?g|svg)$/));\r\n        this.imgList = images;\r\n    },\r\n    mounted() {\r\n\r\n        // 监听窗口大小变化事件，并实时更新数据属性中的宽度和高度值\r\n        // window.addEventListener('resize', this.imageOnload);\r\n        window.onresize = () => {\r\n            clearTimeout(this.timmer)\r\n            setTimeout(() => {\r\n                this.imageOnload()\r\n            }, 600)\r\n        };\r\n    },\r\n    methods: {\r\n        handleImageLoad(index) {\r\n            // //获取主容器宽度\r\n            // var content = this.$refs.content\r\n            // var contentWidth = content.offsetWidth\r\n\r\n            // // img标签的dom数组\r\n            // var imgs = this.$refs.image\r\n            // var imgWidth = imgs[0].offsetWidth\r\n\r\n            // // 获取第一行的图片整数 \r\n            // this.firstRowNums = Math.floor(contentWidth / imgWidth)\r\n\r\n            //     const image = this.$refs.image\r\n            //     if (index < this.firstRowNums) { //第一行\r\n            //         // 获取第一行全部图片的高度 存到数组\r\n            //         var imgHeight = image[index].offsetHeight\r\n            //         this.firstRowImgsHeight.push(imgHeight)\r\n            //     }\r\n            //     else if(index > this.firstRowNums){  //第二行往后\r\n            //         var obj = {\r\n            //             minHeight: this.firstRowImgsHeight[0],   //第一行最短的高度\r\n            //             minIndex: 0  // 第一行高度最矮的那一项的下标\r\n            //         }\r\n            //         console.log(this.firstRowImgsHeight);\r\n            //         for (let j = 0; j < this.firstRowImgsHeight.length; j++) {\r\n            //             if (this.firstRowImgsHeight[j] < obj.minHeight) {  //找到第一行高度最小那一项\r\n            //                 obj.minHeight = this.firstRowImgsHeight[j]\r\n            //                 obj.minIndex = j\r\n            //             }\r\n            //         }\r\n            //         image[index].style.position = \"absolute\"\r\n            //         image[index].style.top = obj.minHeight + \"px\"\r\n            //         image[index].style.left = image[obj.minIndex].offsetLeft + \"px\"\r\n            //         this.firstRowImgsHeight[obj.minIndex] = this.firstRowImgsHeight[obj.minIndex] + image[index].height\r\n            //     }\r\n        },\r\n        imageOnload() { //加载图片 根据浏览器宽度决定列数\r\n            if (window.innerWidth > 1500) {\r\n                this.columns = 4\r\n            } else if (window.innerWidth > 1200) {\r\n                this.columns = 3\r\n            } else if (window.innerWidth > 800) {\r\n                this.columns = 2\r\n            } else if (window.innerWidth >= 500) {\r\n                this.columns = 1\r\n            }\r\n            new WaterFall({ //执行waterfall.js文件中的构造函数\r\n                el: \".wf-content\",\r\n                column: this.columns,\r\n                gap: 23 //间距  单位px\r\n            })\r\n\r\n        },\r\n        loginRegist() {//改变弹窗可视化，触发登陆注册弹窗\r\n            this.$store.commit('turnVisible')\r\n        }\r\n    },\r\n    watch: {\r\n        '$store.state.choose'(newVal) {\r\n            switch (newVal) {\r\n                case 0:\r\n                    this.imgList = null\r\n                    this.imgList = importAll(require.context('@/assets/imgs/recommend', false, /\\.(png|jpe?g|svg)$/));\r\n                    break;\r\n                case 1:\r\n                    this.imgList = null\r\n                    this.imgList = importAll(require.context('@/assets/imgs/art', false, /\\.(png|jpe?g|svg)$/));\r\n                    break;\r\n                case 2:\r\n                    debugger\r\n                    this.imgList = null\r\n                    this.imgList = importAll(require.context('@/assets/video', false, /\\.(mp4)$/));\r\n                    this.imageOnload()\r\n                    //视频标签在浏览器加载完成时调用\r\n                    // window.onload = function () {\r\n                    //     var videoDom = document.getElementById(\"videoList\")\r\n                    //     videoDom.addEventListener(\"canplaythrough\", () => this.imageOnload());\r\n                    // }\r\n                    break;\r\n                case 3:\r\n                    this.imgList = null\r\n                    this.imgList = importAll(require.context('@/assets/imgs/game', false, /\\.(png|jpe?g|svg)$/));\r\n                    break;\r\n                case 4:\r\n                    this.imgList = null\r\n                    this.imgList = importAll(require.context('@/assets/imgs/pet', false, /\\.(png|jpe?g|svg)$/));\r\n                    break;\r\n                case 5:\r\n                    this.imgList = null\r\n                    this.imgList = importAll(require.context('@/assets/imgs/industryDesign', false, /\\.(png|jpe?g|svg)$/));\r\n                    break;\r\n                case 6:\r\n                    this.imgList = null\r\n                    this.imgList = importAll(require.context('@/assets/imgs/car', false, /\\.(png|jpe?g|svg)$/));\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n* {\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\n.Waterfall {\r\n    position: relative;\r\n    margin: 30px auto 0px;\r\n    width: 85%;\r\n\r\n    .wf-item {\r\n        position: absolute;\r\n\r\n        .icons {\r\n            display: none;\r\n            position: absolute;\r\n            width: 30px;\r\n            height: 30px;\r\n        }\r\n\r\n        .collect {\r\n            //收藏\r\n            top: 10px;\r\n            right: 50px;\r\n        }\r\n\r\n        .like {\r\n            //点赞\r\n            top: 10px;\r\n            right: 10px;\r\n        }\r\n\r\n        .download {\r\n            //下载\r\n            bottom: 15px;\r\n            right: 10px;\r\n        }\r\n\r\n        .icons:hover {\r\n            transform: scale(1.1);\r\n        }\r\n\r\n        img {\r\n            width: 100%;\r\n            // border-radius: 10px;\r\n            vertical-align: bottom;\r\n            /*去除图片下方的空隙*/\r\n        }\r\n\r\n        #videoList {\r\n            width: 100%;\r\n            vertical-align: bottom;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    .wf-item:hover {\r\n        transform: scale(1.02);\r\n        cursor: pointer;\r\n    }\r\n\r\n    .wf-item:hover .icons {\r\n        display: block;\r\n    }\r\n\r\n    //鼠标悬停时显示上下内阴影  用before伪元素选择器\r\n    .wf-item:hover::before {\r\n        content: '';\r\n        position: absolute;\r\n        // border-radius: 10px;\r\n        width: 100%;\r\n        height: 100%;\r\n        box-shadow: 0px 90px 60px -50px rgba(0, 0, 0, 0.3) inset, //用逗号间隔，可以设置多个边的内部阴影\r\n            0px -90px 60px -50px rgba(0, 0, 0, 0.3) inset;\r\n        -moz-box-shadow: 0px 90px 60px -50px rgba(0, 0, 0, 0.3) inset, //上内阴影\r\n            0px -90px 60px -50px rgba(0, 0, 0, 0.3) inset; //下内阴影\r\n        -webkit-box-shadow: 0px 90px 60px -50px rgba(0, 0, 0, 0.3) inset,\r\n            0px -90px 60px -50px rgba(0, 0, 0, 0.3) inset;\r\n    }\r\n}\r\n</style>"],"mappings":"AAeA;AACA,SAAAA,SAAA;;AAEA,SAAAC,UAAAC,CAAA;EAAA;EACA,OAAAA,CAAA,CAAAC,IAAA,GAAAC,GAAA,WAAAC,GAAA;IACA,OAAAH,CAAA,CAAAG,GAAA;EACA;AACA;;AAEA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,IAAA;MAAA;MACAC,YAAA;MACAC,kBAAA;MACAC,OAAA;MACAC,MAAA;IACA;EACA;EACAC,QAAA;IACA,MAAAC,MAAA,GAAAd,SAAA,CAAAe,OAAA,CAAAC,OAAA;IACA,KAAAT,OAAA,GAAAO,MAAA;EACA;EACAG,QAAA;IAEA;IACA;IACAC,MAAA,CAAAC,QAAA;MACAC,YAAA,MAAAR,MAAA;MACAS,UAAA;QACA,KAAAC,WAAA;MACA;IACA;EACA;EACAC,OAAA;IACAC,gBAAAC,KAAA;MACA;MACA;MACA;;MAEA;MACA;MACA;;MAEA;MACA;;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IAAA,CACA;IACAH,YAAA;MAAA;MACA,IAAAJ,MAAA,CAAAQ,UAAA;QACA,KAAAf,OAAA;MACA,WAAAO,MAAA,CAAAQ,UAAA;QACA,KAAAf,OAAA;MACA,WAAAO,MAAA,CAAAQ,UAAA;QACA,KAAAf,OAAA;MACA,WAAAO,MAAA,CAAAQ,UAAA;QACA,KAAAf,OAAA;MACA;MACA,IAAAZ,SAAA;QAAA;QACA4B,EAAA;QACAC,MAAA,OAAAjB,OAAA;QACAkB,GAAA;MACA;IAEA;;IACAC,YAAA;MAAA;MACA,KAAAC,MAAA,CAAAC,MAAA;IACA;EACA;EACAC,KAAA;IACA,qBAAAC,CAAAC,MAAA;MACA,QAAAA,MAAA;QACA;UACA,KAAA5B,OAAA;UACA,KAAAA,OAAA,GAAAP,SAAA,CAAAe,OAAA,CAAAC,OAAA;UACA;QACA;UACA,KAAAT,OAAA;UACA,KAAAA,OAAA,GAAAP,SAAA,CAAAe,OAAA,CAAAC,OAAA;UACA;QACA;UACA;UACA,KAAAT,OAAA;UACA,KAAAA,OAAA,GAAAP,SAAA,CAAAe,OAAA,CAAAC,OAAA;UACA,KAAAM,WAAA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;UACA,KAAAf,OAAA;UACA,KAAAA,OAAA,GAAAP,SAAA,CAAAe,OAAA,CAAAC,OAAA;UACA;QACA;UACA,KAAAT,OAAA;UACA,KAAAA,OAAA,GAAAP,SAAA,CAAAe,OAAA,CAAAC,OAAA;UACA;QACA;UACA,KAAAT,OAAA;UACA,KAAAA,OAAA,GAAAP,SAAA,CAAAe,OAAA,CAAAC,OAAA;UACA;QACA;UACA,KAAAT,OAAA;UACA,KAAAA,OAAA,GAAAP,SAAA,CAAAe,OAAA,CAAAC,OAAA;QACA;UACA;MAAA;IAEA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}