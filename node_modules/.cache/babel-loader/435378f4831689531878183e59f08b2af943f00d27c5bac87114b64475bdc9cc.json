{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n// import axios from 'axios'\n\nexport default {\n  name: 'LocalImg',\n  data() {\n    return {\n      imgList: [],\n      firstRowNums: 0,\n      firstRowImgsHeight: []\n    };\n  },\n  created() {\n    const files = require.context(\"@/assets/imgs\", true, /\\.*\\.jpg/).keys();\n    this.imgList = files;\n    // var imgsWidth = imgs[0].offsetWidth\n    // console.log(imgsWidth);\n  },\n\n  mounted() {\n    //获取主容器宽度1\n    // var content = document.getElementsByClassName('content')[0]\n    // var contentWidth = content.offsetWidth  \n    //获取主容器宽度2\n    var content = this.$refs.content;\n    var contentWidth = content.offsetWidth;\n    console.log(contentWidth);\n\n    // img标签的dom数组1\n    // var imgs = content.children\n    // var imgWidth = imgs[0].offsetWidth\n    // img标签的dom数组2\n    var imgs = this.$refs.image;\n    var imgWidth = imgs[0].offsetWidth;\n    console.log(imgWidth);\n\n    // 获取第一行的图片整数 \n    this.firstRowNums = Math.floor(contentWidth / imgWidth);\n    console.log(this.firstRowNums);\n\n    // var firstRowImgsHeight = [] //第一行的高度数组\n    //     for (var i = 0; i < imgs.length; i++) {//imgs.length所有图片的数量\n\n    //     }\n  },\n\n  methods: {\n    handleImageLoad(index) {\n      // console.log($event);\n      const image = this.$refs.image;\n      console.log(image[0].width, image[0].height);\n      if (i < this.firstRowNums) {\n        //第一行\n        // 获取第一行全部图片的高度 存到数组\n        var imgHeight = image[index].offsetHeight;\n        this.firstRowImgsHeight.push(imgHeight);\n      } else {\n        //第二行往后\n        var obj = {\n          minHeight: this.firstRowImgsHeight[0],\n          //第一行最短的高度\n          minIndex: 0 // 第一行高度最矮的那一项的下标\n        };\n\n        for (let j = 0; j < this.firstRowImgsHeight.length; j++) {\n          if (this.firstRowImgsHeight[j] < obj.minHeight) {\n            //找到第一行高度最小那一项\n            obj.minHeight = this.firstRowImgsHeight[j];\n            obj.minIndex = j;\n          }\n        }\n        image[index].style.position = \"absolute\";\n        image[index].style.top = obj.minHeight + \"px\";\n        image[index].style.left = image[obj.minIndex].offsetLeft + \"px\";\n        firstRowImgsHeight[obj.minIndex] = firstRowImgsHeight[obj.minIndex] + imgs[i].offsetHeight;\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","data","imgList","firstRowNums","firstRowImgsHeight","created","files","require","context","keys","mounted","content","$refs","contentWidth","offsetWidth","console","log","imgs","image","imgWidth","Math","floor","methods","handleImageLoad","index","width","height","i","imgHeight","offsetHeight","push","obj","minHeight","minIndex","j","length","style","position","top","left","offsetLeft"],"sources":["src/components/LocalImg.vue"],"sourcesContent":["<template>\r\n    <div id=\"waterfall\">\r\n\r\n        <div class=\"content\" ref=\"content\">\r\n            <!-- 遍历图片数组获取图片 -->\r\n            <div v-for=\"(item, index) in imgList\" :key=\"index\">\r\n                {{ index }}\r\n                <img :src=\"require('../assets/imgs' + item.slice(1))\" alt=\"xxx\" ref=\"image\" @load=\"handleImageLoad(index)\"/>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n// import axios from 'axios'\r\n\r\nexport default {\r\n    name: 'LocalImg',\r\n    data() {\r\n        return {\r\n            imgList: [],\r\n            firstRowNums:0,\r\n            firstRowImgsHeight:[],\r\n\r\n        }\r\n    },\r\n    created() {\r\n        const files = require.context(\"@/assets/imgs\", true, /\\.*\\.jpg/).keys();\r\n        this.imgList = files\r\n        // var imgsWidth = imgs[0].offsetWidth\r\n        // console.log(imgsWidth);\r\n    },\r\n    mounted() {\r\n        //获取主容器宽度1\r\n        // var content = document.getElementsByClassName('content')[0]\r\n        // var contentWidth = content.offsetWidth  \r\n//获取主容器宽度2\r\n        var content = this.$refs.content\r\n        var contentWidth =  content.offsetWidth\r\n        console.log(contentWidth);\r\n\r\n        // img标签的dom数组1\r\n        // var imgs = content.children\r\n        // var imgWidth = imgs[0].offsetWidth\r\n        // img标签的dom数组2\r\n        var imgs = this.$refs.image\r\n        var imgWidth = imgs[0].offsetWidth\r\n        console.log(imgWidth);\r\n\r\n        // 获取第一行的图片整数 \r\n        this.firstRowNums = Math.floor(contentWidth / imgWidth)\r\n        console.log(this.firstRowNums);\r\n\r\n\r\n        // var firstRowImgsHeight = [] //第一行的高度数组\r\n        //     for (var i = 0; i < imgs.length; i++) {//imgs.length所有图片的数量\r\n        \r\n        //     }\r\n\r\n\r\n    },\r\n    methods: {\r\n        handleImageLoad(index){\r\n            // console.log($event);\r\n            const image = this.$refs.image\r\n            console.log(image[0].width,image[0].height);\r\n\r\n                if (i < this.firstRowNums) { //第一行\r\n                    // 获取第一行全部图片的高度 存到数组\r\n                    var imgHeight = image[index].offsetHeight\r\n                    this.firstRowImgsHeight.push(imgHeight)\r\n                }\r\n                else {  //第二行往后\r\n                    var obj = {\r\n                        minHeight: this.firstRowImgsHeight[0],   //第一行最短的高度\r\n                        minIndex: 0  // 第一行高度最矮的那一项的下标\r\n                    }\r\n                    for (let j = 0; j < this.firstRowImgsHeight.length; j++) {\r\n                        if (this.firstRowImgsHeight[j] < obj.minHeight) {  //找到第一行高度最小那一项\r\n                            obj.minHeight = this.firstRowImgsHeight[j]\r\n                            obj.minIndex = j\r\n                        }\r\n                    }\r\n                    image[index].style.position = \"absolute\"\r\n                    image[index].style.top = obj.minHeight + \"px\"\r\n                    image[index].style.left = image[obj.minIndex].offsetLeft + \"px\"\r\n                    firstRowImgsHeight[obj.minIndex] = firstRowImgsHeight[obj.minIndex] + imgs[i].offsetHeight\r\n                }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n* {\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\n#waterfall {\r\n    width: 84.5%;\r\n    margin: 0 auto;\r\n}\r\n\r\n.content {\r\n    width: 100%;\r\n\r\n    div {\r\n        float: left;\r\n        padding: 10px;\r\n\r\n        img {\r\n            width: 300px;\r\n            border-radius: 10px;\r\n        \r\n        }\r\n    }\r\n\r\n}\r\n</style>"],"mappings":";AAeA;;AAEA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,YAAA;MACAC,kBAAA;IAEA;EACA;EACAC,QAAA;IACA,MAAAC,KAAA,GAAAC,OAAA,CAAAC,OAAA,oCAAAC,IAAA;IACA,KAAAP,OAAA,GAAAI,KAAA;IACA;IACA;EACA;;EACAI,QAAA;IACA;IACA;IACA;IACA;IACA,IAAAC,OAAA,QAAAC,KAAA,CAAAD,OAAA;IACA,IAAAE,YAAA,GAAAF,OAAA,CAAAG,WAAA;IACAC,OAAA,CAAAC,GAAA,CAAAH,YAAA;;IAEA;IACA;IACA;IACA;IACA,IAAAI,IAAA,QAAAL,KAAA,CAAAM,KAAA;IACA,IAAAC,QAAA,GAAAF,IAAA,IAAAH,WAAA;IACAC,OAAA,CAAAC,GAAA,CAAAG,QAAA;;IAEA;IACA,KAAAhB,YAAA,GAAAiB,IAAA,CAAAC,KAAA,CAAAR,YAAA,GAAAM,QAAA;IACAJ,OAAA,CAAAC,GAAA,MAAAb,YAAA;;IAGA;IACA;;IAEA;EAGA;;EACAmB,OAAA;IACAC,gBAAAC,KAAA;MACA;MACA,MAAAN,KAAA,QAAAN,KAAA,CAAAM,KAAA;MACAH,OAAA,CAAAC,GAAA,CAAAE,KAAA,IAAAO,KAAA,EAAAP,KAAA,IAAAQ,MAAA;MAEA,IAAAC,CAAA,QAAAxB,YAAA;QAAA;QACA;QACA,IAAAyB,SAAA,GAAAV,KAAA,CAAAM,KAAA,EAAAK,YAAA;QACA,KAAAzB,kBAAA,CAAA0B,IAAA,CAAAF,SAAA;MACA,OACA;QAAA;QACA,IAAAG,GAAA;UACAC,SAAA,OAAA5B,kBAAA;UAAA;UACA6B,QAAA;QACA;;QACA,SAAAC,CAAA,MAAAA,CAAA,QAAA9B,kBAAA,CAAA+B,MAAA,EAAAD,CAAA;UACA,SAAA9B,kBAAA,CAAA8B,CAAA,IAAAH,GAAA,CAAAC,SAAA;YAAA;YACAD,GAAA,CAAAC,SAAA,QAAA5B,kBAAA,CAAA8B,CAAA;YACAH,GAAA,CAAAE,QAAA,GAAAC,CAAA;UACA;QACA;QACAhB,KAAA,CAAAM,KAAA,EAAAY,KAAA,CAAAC,QAAA;QACAnB,KAAA,CAAAM,KAAA,EAAAY,KAAA,CAAAE,GAAA,GAAAP,GAAA,CAAAC,SAAA;QACAd,KAAA,CAAAM,KAAA,EAAAY,KAAA,CAAAG,IAAA,GAAArB,KAAA,CAAAa,GAAA,CAAAE,QAAA,EAAAO,UAAA;QACApC,kBAAA,CAAA2B,GAAA,CAAAE,QAAA,IAAA7B,kBAAA,CAAA2B,GAAA,CAAAE,QAAA,IAAAhB,IAAA,CAAAU,CAAA,EAAAE,YAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}